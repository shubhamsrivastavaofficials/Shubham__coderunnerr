<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced Code Notepad</title>
<style>
  body { margin:0; font-family: Arial, sans-serif; }
  header { background:#4CAF50; color:white; padding:10px; display:flex; justify-content:space-between; align-items:center; }
  header h1 { margin:0; font-size:1.2rem; }
  header button { padding:5px 10px; cursor:pointer; }

  #tabs { display:flex; border-bottom:1px solid #ccc; background:#eee; }
  .tab { padding:5px 15px; cursor:pointer; border-right:1px solid #ccc; }
  .tab.active { background:white; font-weight:bold; }

  #editor-container { display:flex; flex-direction:column; height:70vh; }
  textarea { flex:1; width:100%; padding:10px; font-family: monospace; font-size:14px; border:none; border-top:1px solid #ccc; resize:none; }

  #controls { padding:5px; display:flex; justify-content:flex-end; background:#f0f0f0; }
  #controls button { margin-left:5px; padding:5px 10px; cursor:pointer; }

  #preview { border-top:1px solid #ccc; height:200px; overflow:auto; padding:5px; background:#fafafa; }
</style>
</head>
<body>

<header>
  <h1>Shubham's Advanced Code Notepad</h1>
  <div>
    <button onclick="addTab()">New File</button>
    <button onclick="saveFile()">Save</button>
    <button onclick="saveAsFile()">Save As</button>
    <button onclick="runCode()">Run Code</button>
    <button onclick="openFile()">Open File</button>
  </div>
</header>

<div id="tabs"></div>

<div id="editor-container">
  <textarea id="editor" placeholder="Write HTML/CSS/JS code here..."></textarea>
</div>

<div id="preview"></div>

<input type="file" id="fileInput" style="display:none" accept=".txt,.html">

<script>
let tabs = [];
let currentTab = 0;

function addTab(name='Untitled') {
  const tab = { name, content:'', filename:null };
  tabs.push(tab);
  currentTab = tabs.length-1;
  renderTabs();
  renderEditor();
}

function renderTabs() {
  const container = document.getElementById('tabs');
  container.innerHTML = '';
  tabs.forEach((tab,index)=>{
    const div = document.createElement('div');
    div.className = 'tab'+(index===currentTab?' active':'');
    div.textContent = tab.name;
    div.onclick = ()=> { saveContent(); currentTab=index; renderTabs(); renderEditor(); };
    container.appendChild(div);
  });
}

function renderEditor() {
  document.getElementById('editor').value = tabs[currentTab]?.content || '';
}

function saveContent() {
  if(tabs[currentTab]) tabs[currentTab].content = document.getElementById('editor').value;
}

function saveFile() {
  saveContent();
  const tab = tabs[currentTab];
  if(tab.filename) {
    downloadFile(tab.content, tab.filename);
  } else {
    saveAsFile();
  }
}

function saveAsFile() {
  saveContent();
  const tab = tabs[currentTab];
  const filename = prompt("Enter file name", tab.name+'.txt');
  if(filename) {
    tab.filename = filename;
    tab.name = filename.replace(/\.(txt|html)$/,'');
    downloadFile(tab.content, filename);
    renderTabs();
  }
}

function downloadFile(content, filename) {
  const blob = new Blob([content], {type:'text/plain'});
  const link = document.createElement('a');
  link.download = filename;
  link.href = URL.createObjectURL(blob);
  link.click();
}

function openFile() {
  document.getElementById('fileInput').click();
}

document.getElementById('fileInput').addEventListener('change', (e)=>{
  const file = e.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = function(ev){
    const content = ev.target.result;
    addTab(file.name.replace(/\.(txt|html)$/,''));
    tabs[tabs.length-1].content = content;
    tabs[tabs.length-1].filename = file.name;
    currentTab = tabs.length-1;
    renderTabs();
    renderEditor();
  };
  reader.readAsText(file);
});

function runCode() {
  saveContent();
  const preview = document.getElementById('preview');
  const code = tabs[currentTab]?.content || '';
  preview.innerHTML = code;
}

// Initialize first tab
addTab();

// Keyboard shortcuts
document.addEventListener('keydown',(e)=>{
  if(e.ctrlKey && e.key==='s'){ e.preventDefault(); saveFile(); }
  if(e.ctrlKey && e.key==='n'){ e.preventDefault(); addTab(); }
});
</script>

</body>
</html>
